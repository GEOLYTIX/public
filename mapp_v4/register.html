<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:site_name" content="Geolytix MAPP" />
  <meta property="og:title" content="Sign Up | Geolytix MAPP" />
  <meta property="og:type" content="website" />

  <title>Register | Geolytix MAPP</title>

  <link rel="icon" type="image/x-icon" href="https://geolytix.github.io/public/favicon_mapp.ico" />
  <link rel="stylesheet" href="https://geolytix.github.io/public/mapp_v4/app.css" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
</head>

<body>
  <main>

    <div class="form-container">
      <div class="form-container__inner">
        <div class="flow">
          <div class="text-align-center">
            <div class="gap-bottom-600">
              <img src="https://geolytix.github.io/public/mapp/mapp_logo.svg" class="logo" alt="Geolytix logo">
            </div>

            <h1 class="form-container__title">Sign up for an account</h1>
          </div>

          <form method="post" class="[ form-box panel ] [ flow ]">

            <input style="display:none;" name="language" required value="en">

            <input style="display: none;" name="register" value=true>

            <div class="form-field">
              <label>Email address</label>
              <input name="email" type="email" autocomplete="off" required maxlength="50" value=""
                placeholder="Enter email">
            </div>

            <div class="form-field">
              <label>Password</label>
              <div class="password-container">
                <input type="password" id="password" class="password-input" required minlength="12" name="password"
                  placeholder="Enter password" oninput="checkPassword()" autocomplete="current-password">
                <span id="toggle_password" class="toggle-password material-symbols-outlined">visibility_off</span>
              </div>
            </div>

            <div class="form-field">
              <label>Confirm Password</label>
              <div class="password-container">
                <input type="password" id="confirm_password" class="password-input" required minlength="12"
                  name="confirm_password" placeholder="Enter password" oninput="checkPassword()"
                  autocomplete="new-password">
                <span id="toggle_confirm_password"
                  class="toggle-password material-symbols-outlined">visibility_off</span>
              </div>
            </div>

            <p id="password_match_message"></p>

            <button class="button disabled" id="submitbutton" type="submit" formaction="register">
              Sign up
            </button>

            <p class="gap-top-700"><a href="{{dir}}/?login">Already have an account?</a></p>
          </form>

          <div class="text-align-center">
            <p class="text-300">By signing up you agree to our <a
                href="https://geolytix.github.io/public/mapp/terms.html">Terms of Service</a> & <a
                href="https://geolytix.github.io/public/mapp/privacy.html">Privacy Policy</a>. After verification, a
              site administrator will approve new accounts.
              You will receive a further email once your account has been approved.</p>
          </div>
        </div>
      </div>
    </div>
  </main>
  <script>

    const togglePasswordButton = document.getElementById('toggle_password');
    const passwordInput = document.getElementById('password');

    togglePasswordButton.addEventListener('click', function () {
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        togglePasswordButton.innerText = "visibility";
      } else {
        passwordInput.type = 'password';
        togglePasswordButton.innerText = "visibility_off";
      }
    });

    const toggleConfirmPasswordButton = document.getElementById('toggle_confirm_password');
    const ConfirmpasswordInput = document.getElementById('confirm_password');

    toggleConfirmPasswordButton.addEventListener('click', function () {
      if (ConfirmpasswordInput.type === 'password') {
        ConfirmpasswordInput.type = 'text';
        toggleConfirmPasswordButton.innerText = "visibility";
      } else {
        ConfirmpasswordInput.type = 'password';
        toggleConfirmPasswordButton.innerText = "visibility_off";
      }
    });

    function checkPassword() {

      // Get the password field
      const password = document.getElementById("password").value;

      // Get the confirm password field
      const confirmPassword = document.getElementById("confirm_password").value;

      // Get the message element
      const message = document.getElementById("password_match_message");

      // Define
      const requiredPattern = new RegExp("(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])^.{12,}$");

      // Check the pattern agains the password
      if (!requiredPattern.test(password)) {
        message.innerHTML = "Your Password must contain a number, upper and lower case letter and be 12 characters or greater.";
        message.style.color = "black";
      }
      // If the password meets criteria, then check if the passwords match
      else {
        if (password === confirmPassword) {
          message.innerHTML = "";
          document.getElementById("submitbutton").classList.remove("disabled");
        } else {
          message.innerHTML = "Passwords must match!";
          message.style.color = "red";
        }
      }
    }
  </script>
</body>

</html>